\chapter{Realisierung}
\section{Modellierung}
Blenderplugin, IFCWallTypes Module die das Raster vorgeben etc.

\section{Wall Detailing}
Als \glqq{}Wall Detailing\grqq{} (sprich das \glqq{}Detailieren von Wänden\grqq{}) wird in dieser Arbeit der Vorgang ein als geometrischer Körper definiertes Wandstück in ein konkretes Mauerwerk zu überführen, bezeichnet.
Innerhalb des IFC Standards werden einige mathematische/geometrische Repräsentationen der sogennanten \textit{IFCWall} unterstützt, um neben einfachen Boxen auch komplexere Formen abbilden zu können.
Beispielsweise ist es möglich in das Modell eines Hauses zunehmend dünner werdende Wandstücke, kurvige Wandstücke oder Wandstücke, welche nur durch ein arbiträres Vieleck beschrieben werden können zu integrieren.
Allerdings ist es für die Fallstudien dieser Arbeit zunächst ausreichend nur Wandstücke, welche als einfacher geometrischer Quader vorliegen, zu beachten.
Das nachfolgende schrittweise Vorgehen weist aufgrund des annähernd gleichen Ergebnisses zwangsläufig Ähnlichkeiten zu dem von Usmanov et al. auf \cite{Usmanov2021}.

\subsection{Konvertieren des IFC zu BREP}
Den ersten Schritt stellt das Extrahieren aller notwendigen Daten aus dem vorliegenden IFC Modell dar.
Für die Fallstudien dieser Arbeit sind sowohl alle Objekte des Typs \textit{IFCWall} als auch die, etwa durch Fenster oder Türen entstehenden, daran angeknüpften Objekte vom Typ \textit{IfcOpeningElement} (siehe \ref{basics:IfcOpeningElement}) von Interesse.
Zusätzlich werden aus den, in den \textit{IfcPropertySets} der Wandstücke hinterlegten Daten, Informationen über das zu verwendende Modul ausgelesen.
Mithilfe der Werkzeuge der in Kapitel \ref{basics} vorgstellten Python Bibliothek \textit{ifcopenshell} (siehe \ref{basics:ifcopenshell}) ist dies intuitiv möglich.
TODO Sätze zum Code, Code TODO kleines Klassendiagram von Wall/WallLayerGroup und Opening und BrickInformation

\subsection{Überprüfen der modellierten Wände}
\subsubsection{Filtern}
Da sich diese Arbeit vorerst ausschließlich mit quaderförmigen Wandstücken beschäftigt, müssen zunächst alle zuvor extrahierten Wandstücke auf diese Eigenschaft geprüft werden.
Somit ist gewährleistet, dass lediglich passende Wandstücke an die nachfolgenden Schritte weitergegeben werden.
TODO Satz zum Code, Code iscubic

\subsubsection{Anwenden des Moduls}
Mit dem zu jedem Wandstück festgelegten Modul werden nun alle Wandstücke in Schichten aufgeteilt.
Deren Höhe entspricht im Normalfall der Höhe des jeweilgen Moduls.
Lediglich die oberste Schicht kann durch falsch modellierte Wandstücke eine niedrigere Schichthöhe aufweisen.
Dies ist der Fall, wenn die Gesamthöhe des Wandstücks nicht exakt einem Vielfachen der Höhe des Moduls entspricht und ein nicht aufzuteilender Rest existiert.
Das Aufteilen in Schichten erleichtert es im Anschluss Berechnungen an Wandstücken durchzuführen und Beziehungen zwischen ihnen zu finden.

\subsubsection{Kombinieren passender Wandstücke}
Eine solche Beziehung stellen etwa Wandstücke dar, die zwar in dem Modellierungsprozess des Gebäudes durch mehrere einzelne Objekte realisiert wurden, eigentlich aber eine Einheit darstellen.
Daher werden in diesem Schritt alle Wandstücke miteinander verglichen und eventuell kombiniert, sodass jeweils ein gefundes Paar durch ein einzelnes Wandstück representiert wird.
Um zwei Wandstücke zu kombinieren müssen folgende Eigenschaften gelten:
* Beide Wandstücke verwenden das selbe Modul und sind während der Modellierung mit den gleichen Wandtyp annotiert worden. -> Dies verhindert das Kombinieren unterschiedlich dicker Wände
* Die lokalen Z-Achsen beider Wandstücke sind parallel. -> Dies verhindert das Kombinieren ungleich rotierter Wandstücke
* Sie stehen auf der selben Höhe oder versetzt um ein Vielfaches der gemeinsamen Modulhöhe.
* Die lokalen X-Achsen beider Wandstücke sind ebenfalls parallel.
* Mindestens eine Schicht des einen Wandstücks berührt oder überlappt eine des anderen.

TODO: Bilder und Erklärung der verschiedenen Fälle
Steht ein Wandstück in X-Richtung versetzt auf einem anderem, so ist es notwendig diesen Versatz während dem nachfolgenden Detailing zu berücksichtigen.
Ignoriert man diesen Versatz kann dies zu den in Abbildung TODO gezeigten Fehlern führen.
Dieser, nachfolgend als \textit{x\_offset} bezeichnete Versatz ist definiert durch die Differenz zwischen der kleinsten lokalen X-Koordinate aller Schichten eines Wandstückes und der lokalen X-Koordinate der zu betrachtenden Schicht.
Der daraus resultierende Wert wird später dazu verwendet den anzuwendenden Mauerwerksverband an erst an der passenden Stelle zu beginnen.
Dadurch erzielt man einen einheitlichen Verband über das gesamte Wandstück und verhindert den in Abbildung TODO Fehlerfall.
Eine weitere Eigenschaft, die aus dem Kombinieren zweier Wandstücke entstehen kann, ist das vorhandensein unterbrochender Schichten beziehungsweise mehrerer Schichten auf einer Höhe innerhalb eines Wandstückes.
Dies ist ebenfalls in Abbildung TODO dargestellt.
Durch das Einbeziehen des \textit{x\_offset} können derartige Situationen jedoch ebenfalls gelöst werden, da für jedes Teilstück einer Schicht ein eigener \textit{x\_offset} berechnet wird.
Auch dies ist der Abbildung TODO zu entnehmen.

\subsubsection{Beziehungen finden}
Nun wird die aus dem vorherigen Schritt entstandene neue Menge an Wandstücken auf weitere Beziehungen untersucht.
Für das Wall Detailing relevante Beziehungen stellen Ecken, T-Kreuzungen und X-Kreuzungen dar.
Es werden wie oben wiederum nur die Wandstücke miteinander verglichen, die mit dem selben Wandtyp annotiert wurden und das gleiche Modul verwenden.
Diese Beziehungen ähneln sich stark und besitzen demnach einige geteilten Eigenschaften:
* Die lokalen Z-Achsen beider Wandstücke sind parallel.
* Sie stehen auf der selben Höhe oder versetzt um ein Vielfaches der gemeinsamen Modulhöhe.
* Mindestens eines der beiden Wandstücke endet auf einem anderen, sodass mindestens eine Schicht das andere Wandstück direkt berührt.
Außerdem 
Durchlaufe alle Wandstücke und schau, ob diese andere berühren.
Dadurch können Ecken, T-Kreuzungen und Kreuzungen gefunden werden.
Schwierigkeiten: Verschiedenste Arten solche Ecken und Kreuzungen zu modellieren 

\subsection{Lösen der Beziehungen}
Je nach gewählten Verband müssen z.B. Ecken (deren Baupläne im vornherein definiert wurden) so angeordnet werden, dass die dazwischenliegenden Wandstücke lückenlos eingefüllt werden können.
Dafür muss ein sogenannter "plan\_offset" für jede Wand und jede Ecke gefunden werden. Dieser gibt an, an welchem Index der Bauplandefinition das Wandstück (von unten) beginnen muss, um insgesamt einen einheitlichen Wandkörper ohne Lücken zu bilden.
Voraussetzung dafür ist natürlich ein passender Eckplan zu dem gewählten Verband. 

Schwierigkeiten: Eckpläne insgesamt, Ecken ragen in die sie bildenden Wände hinein. Diese müssen dementsprechend verkleinert werden.

\subsection{Anwenden der Lösung}
Ablaufen aller Ecken und Wände und einsetzen der Ziegel gemäß den gefundenen Lösungen.

\subsection{Export}
Abhängigkeitsgraph und Ontologie für Regelwerk